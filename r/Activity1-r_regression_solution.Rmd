---
title: "R and Regression"
author: "Unnati Narang"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Activity description and instructions

There are 3 questions in this activity based on the Boston housing dataset, requiring R code in order to solve it. Create an R code chunk (remember the keyboard shortcut?) below each part of the question and type your code.

### Team work makes the dream work! 

Your task is to work in teams to solve the problems together with your partner. Please submit your own individual .html file (with the results printed out) in Canvas. Mention if you worked with anyone else. 

It's an "open book" activity. Feel free to use your notes, ask your partner, etc. but write your own final code.

At any point, you can view your updated worksheet in the browser (.html) by using the knit option (What does Ctrl+Shift+K do?).

### Your Turn to Try It!

Question 1. Read the dataset “housing.csv” into a dataframe. [.25]

[HINT: Remember to save in the current working directory (use getwd() to see the current directory)]

```{r}
housing <- read.csv("housing.csv")
```


Question 2. 

a. Examine the descriptive statistics (e.g., mean, median, sd) of the median value of owner-occupied homes, no. of rooms, and % of lower status of the population. [.5]

```{r}
mean(housing$MDEV)
median(housing$MDEV)
sd(housing$MDEV)

mean(housing$LSTAT)
median(housing$LSTAT)
sd(housing$LSTAT)

mean(housing$RM)
median(housing$RM)
sd(housing$RM)
```

b. Create a plot of the median home value variable you used in (a) above. Can you create a density plot? (i.e., plot(density(...))). [.5]

```{r}
plot(density(housing$MDEV), main = "Housing Prices")
```

c. We want to compare home values in areas with greater (vs lesser) % of lower status of the population. Can you create a new variable/column in the dataset called low_status, which takes the value 1 if the value of LSTAT > median(LSTAT)? Check how many rows belong to the "low_status" (1 vs 0) using table. What do you notice? [.25]

```{r}
housing$low_status <- 1*(housing$LSTAT > median(housing$LSTAT))
table(housing$low_status)
```

d. Now conduct a ttest to compare the median home value for homes with low_status == 1 & homes with low_status == 0. Interpret the results. [.25]

```{r}
t.test(housing$MDEV[which(housing$low_status==1)], housing$MDEV[which(housing$low_status==0)])
```
##### the results show that there is a significant difference between home prices in high vs low status areas.

e. Can you examine the correlations of median home value with other variables: average no. of rooms and % of lower status of the population. [.5]

```{r}
cor(housing$MDEV, housing$RM)
cor(housing$MDEV, housing$LSTAT)
```


f. Can you create a list of these two variable names (i.e., average no. of rooms and % of lower status of the population) then write a loop over these two variables that prints the correlation of median home value with each of the two? HINT: Use the exact variable name in strings, e.g., c("RM") so you can use that column name inside your loop. [.5]

```{r}
l <- c("RM", "LSTAT")
for (item in l){
  print(cor(housing$MDEV, housing[,(item)]))
}
```


Question 3a. 

Estimate a regression model for median home price as the Y variable using different sets of X variables. [.25 * 3 + .5 interpretation]

a. Only LSTAT 
b. Only RM (no. of rooms)
c. Both LSTAT and RM (no. of rooms)

# interpret the results. 

```{r}
summary(lm(MDEV ~ LSTAT, data = housing))
summary(lm(MDEV ~ RM, data = housing))
summary(lm(MDEV ~ LSTAT + RM, data = housing))

# Model with both variables has the highest R-squared. Both LSTAT and RM are significantly related with median prices, but LSTAT has a negative and RM has a positive relationship. 
```

BONUS

Write a function that takes a dataframe name and two column ids as inputs and prints the results of the regression of the first column (Y) on the second column (X). Invoke this function with (your_data_name, 14, 13) as inputs. What do you get? Check if the results are equivalent to the results in 3a(a). [.5 subject to max of 4]

```{r}
reg_func <- function(data, y, x){
  print(summary(lm(data[,y] ~ data[,x])))
}

reg_func(housing, 14, 13)
```

